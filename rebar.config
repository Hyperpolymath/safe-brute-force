{erl_opts, [
    debug_info,
    deterministic,           % Remove timestamps for reproducible builds
    warnings_as_errors,      % Strict compilation
    warn_export_vars,
    warn_shadow_vars,
    warn_obsolete_guard
]}.

{deps, [
    {lfe, "2.1.5"},
    {lhttpc, "1.5.3"},  % HTTP client for testing web endpoints
    {uuid, "2.0.7", {pkg, uuid_erl}}  % For checkpoint IDs
]}.

{plugins, [
    {rebar3_lfe, "0.4.9"}
]}.

{provider_hooks, [
    {pre, [{compile, {lfe, compile}}]}
]}.

{profiles, [
    {test, [
        {deps, [
            {proper, "1.4.0"}
        ]},
        {eunit_opts, [verbose]}
    ]},
    {prod, [
        {erl_opts, [
            deterministic,
            no_debug_info,
            warnings_as_errors
        ]},
        {relx, [{dev_mode, false}, {include_erts, true}]}
    ]}
]}.

%% Dialyzer configuration for type checking
{dialyzer, [
    {warnings, [
        error_handling,
        race_conditions,
        underspecs,
        unknown,
        unmatched_returns
    ]},
    {get_warnings, true},
    {plt_apps, top_level_deps},
    {plt_extra_apps, []},
    {plt_location, local},
    {base_plt_apps, [stdlib, kernel, erts, sasl]},
    {base_plt_location, global}
]}.

{project_plugins, [
    {rebar3_lfe, "0.4.9"}
]}.

{lfe, [
    {main, "sbf"},
    {app, "safe_brute_force"}
]}.

{relx, [
    {release, {safe_brute_force, "0.1.0"},
     [safe_brute_force,
      sasl]},

    {mode, dev},

    {sys_config, "./config/sys.config"},
    {vm_args, "./config/vm.args"},

    {dev_mode, true},
    {include_erts, false},

    {extended_start_script, true}
]}.
